# HEPTAPOD S1 scalar leptoquark signal generation
#
# Model choice:
#   - Use the existing UFO model LQnlo_5FNS_v5_UFO shipped with MG5_aMC.
#   - Identify the scalar leptoquark S1 with the field LQ1d (and its
#     antiparticle LQ1d~) in this model. LQ1d is a colour-triplet scalar
#     with electric charge -1/3; its antiparticle LQ1d~ has charge +1/3,
#     which matches the S1 quantum numbers up to conjugation.
#   - The model implements generic leptoquark couplings; below we restrict
#     them to a simple structure dominated by a single electron–up-quark
#     coupling (y1RR(1,1)), approximating the simplified S1 setup.
#
# Collider and run setup:
#   - Proton–proton collisions at sqrt(s) = 8 TeV (ebeam1 = ebeam2 = 4000 GeV).
#   - LO matrix elements with Pythia8 showering via the MG5aMC_PY8_interface.
#   - PDF: NNPDF31_lo_as_0130 (LHAPDF set index 315200).
#   - Target: 20000 showered events per S1 mass point.

import model LQnlo_5FNS_v5_UFO

define p = g u c d s u~ c~ d~ s~
define j = u c d s u~ c~ d~ s~

define l+ = e+
define l- = e-

# Signal process: pp -> LQ1d LQ1d~ at parton level.
# The subsequent decays LQ1d/LQ1d~ -> e u (plus jets) are handled by
# Pythia8 using the SLHA decay table from the param_card.
generate p p > LQ1d LQ1d~

output /workspace/heptapod/mg_run/s1_pair -f

###############################################
# Common settings for all subsequent launches #
###############################################

# Run 1: m_S1 = 1000 GeV
launch /workspace/heptapod/mg_run/s1_pair -n s1_m1000

  # Enable Pythia8 showering via MG5_aMC run interface (MG5 3.7.0-compatible)
  shower=Pythia8

  # Collider setup: 8 TeV pp
  set run_card ebeam1 4000
  set run_card ebeam2 4000

  # PDF choice: NNPDF31_lo_as_0130 (LO set, LHAPDF ID 315200)
  set run_card pdlabel lhapdf
  set run_card lhaid 315200

  # Event statistics
  set run_card nevents 20000

  # Simple flavour structure for S1 Yukawas:
  #  - Keep y1RR(1,1) at O(0.3) as the dominant coupling, corresponding
  #    roughly to an e_R–u_R interaction.
  #  - Suppress other real entries in LQY1RR and all real entries in
  #    LQY1LL to approximate a single-flavour, right-handed structure.
  #  - Imaginary parts (IMLQY1RR/IMLQY1LL) are left at their small
  #    default values, so residual off-diagonal couplings are negligible.

  # LQY1RR block (real parts)
  set param_card LQY1RR 1 1 0.3
  set param_card LQY1RR 1 2 0.0
  set param_card LQY1RR 1 3 0.0
  set param_card LQY1RR 2 1 0.0
  set param_card LQY1RR 2 2 0.0
  set param_card LQY1RR 2 3 0.0
  set param_card LQY1RR 3 1 0.0
  set param_card LQY1RR 3 2 0.0
  set param_card LQY1RR 3 3 0.0

  # LQY1LL block (real parts) set to zero to remove left-handed couplings
  set param_card LQY1LL 1 1 0.0
  set param_card LQY1LL 1 2 0.0
  set param_card LQY1LL 1 3 0.0
  set param_card LQY1LL 2 1 0.0
  set param_card LQY1LL 2 2 0.0
  set param_card LQY1LL 2 3 0.0
  set param_card LQY1LL 3 1 0.0
  set param_card LQY1LL 3 2 0.0
  set param_card LQY1LL 3 3 0.0

  # S1 mass parameter: MS1 is stored in Block MASS with code 6000042.
  set param_card MASS 6000042 1000.0

  # Use default DECAY entries (O(10 GeV)) as a narrow-width assumption.

  0

shell cp /workspace/heptapod/mg_run/s1_pair/Events/s1_m1000/tag_1_pythia8_events.hepmc.gz /workspace/heptapod/mg_run/s1_pair/Events/s1_m1000/hepmc.gz


# Run 2: m_S1 = 1500 GeV
launch /workspace/heptapod/mg_run/s1_pair -n s1_m1500

  # Enable Pythia8 showering
  shower=Pythia8

  set run_card ebeam1 4000
  set run_card ebeam2 4000
  set run_card pdlabel lhapdf
  set run_card lhaid 315200
  set run_card nevents 20000

  # Reapply Yukawa structure in case the default cards were restored
  set param_card LQY1RR 1 1 0.3
  set param_card LQY1RR 1 2 0.0
  set param_card LQY1RR 1 3 0.0
  set param_card LQY1RR 2 1 0.0
  set param_card LQY1RR 2 2 0.0
  set param_card LQY1RR 2 3 0.0
  set param_card LQY1RR 3 1 0.0
  set param_card LQY1RR 3 2 0.0
  set param_card LQY1RR 3 3 0.0

  set param_card LQY1LL 1 1 0.0
  set param_card LQY1LL 1 2 0.0
  set param_card LQY1LL 1 3 0.0
  set param_card LQY1LL 2 1 0.0
  set param_card LQY1LL 2 2 0.0
  set param_card LQY1LL 2 3 0.0
  set param_card LQY1LL 3 1 0.0
  set param_card LQY1LL 3 2 0.0
  set param_card LQY1LL 3 3 0.0

  set param_card MASS 6000042 1500.0

  0

shell cp /workspace/heptapod/mg_run/s1_pair/Events/s1_m1500/tag_1_pythia8_events.hepmc.gz /workspace/heptapod/mg_run/s1_pair/Events/s1_m1500/hepmc.gz


# Run 3: m_S1 = 2000 GeV
launch /workspace/heptapod/mg_run/s1_pair -n s1_m2000

  # Enable Pythia8 showering
  shower=Pythia8

  set run_card ebeam1 4000
  set run_card ebeam2 4000
  set run_card pdlabel lhapdf
  set run_card lhaid 315200
  set run_card nevents 20000

  set param_card LQY1RR 1 1 0.3
  set param_card LQY1RR 1 2 0.0
  set param_card LQY1RR 1 3 0.0
  set param_card LQY1RR 2 1 0.0
  set param_card LQY1RR 2 2 0.0
  set param_card LQY1RR 2 3 0.0
  set param_card LQY1RR 3 1 0.0
  set param_card LQY1RR 3 2 0.0
  set param_card LQY1RR 3 3 0.0

  set param_card LQY1LL 1 1 0.0
  set param_card LQY1LL 1 2 0.0
  set param_card LQY1LL 1 3 0.0
  set param_card LQY1LL 2 1 0.0
  set param_card LQY1LL 2 2 0.0
  set param_card LQY1LL 2 3 0.0
  set param_card LQY1LL 3 1 0.0
  set param_card LQY1LL 3 2 0.0
  set param_card LQY1LL 3 3 0.0

  set param_card MASS 6000042 2000.0

  0

shell cp /workspace/heptapod/mg_run/s1_pair/Events/s1_m2000/tag_1_pythia8_events.hepmc.gz /workspace/heptapod/mg_run/s1_pair/Events/s1_m2000/hepmc.gz

quit